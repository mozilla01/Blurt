<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title><%=user.username%>'s Profile</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM"
      crossorigin="anonymous"
    />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Montserrat:wght@500;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200"
    />

    <link rel="stylesheet" href="/stylesheets/profile2.css" />
  </head>
  <body>
    <section class="container-fluid">
      <div class="row">
        <div class="col-xl-3 col-lg-4 text-center bg-white" id="left-sidebar">
          <div id="image-container">
            <% if(user.image) {%>
            <img src="<%=user.image.profile%>" alt="" />
            <% } else {%>
            <img
              src="https://res.cloudinary.com/dyg5zmebj/image/upload//c_fill,g_face,h_200,w_200/f_png/r_max/v1688626927/Social-Media/umntgolhyfldrjkcxm27.jpg"
              alt=""
            />
            <% } %>
          </div>
          <div id="name-container">
            <h2><%=user.firstname%> <%=user.lastname%></h2>
          </div>
          <div id="username-container">
            <h3>@<%=user.username%></h3>
          </div>
          <div id="follow-container" class="btn-group">
            <a href=""
              ><button class="btn btn-light">
                <h4>
                  <%=user.followers.length %>
                  <%=(user.followers.length===1)?"Follower":"Followers"%>
                </h4>
              </button></a
            >
            <a href=""
              ><button class="btn btn-light">
                <h4><%=user.following.length %> Following</h4>
              </button></a
            >
          </div>
          <div id="follow-btn-container">
            <%if (thisUser.following.some((following) => following.username ===
            user.username)) {%>
            <form
              action="/social-media/<%=thisUser.username%>/friends"
              class="ms-auto"
            >
              <button class="btn btn-success mt-3">
                <span> Following </span>
              </button>
            </form>
            <% } else if(thisUser.requested_outgoing.some((req_inc) =>
            req_inc.username === user.username)) {%>
            <form
              action="/social-media/<%=user.username%>/cancelrequest"
              class="ms-auto"
            >
              <button class="btn btn-light mt-3">
                <span> Requested </span>
              </button>
            </form>
            <% } else if(thisUser.followers.some((followerz) =>
            followerz.username === user.username)) {%>
            <form
              action="/social-media/<%= user.username %>/followrequest"
              class="ms-auto"
            >
              <button class="btn btn-primary mt-3">
                <span> Follow Back</span>
              </button>
            </form>
            <% } else if(thisUser.username===user.username) {} else {%>
            <form
              action="/social-media/<%= user.username %>/followrequest"
              class="ms-auto"
            >
              <button class="btn btn-dark mt-3">
                <span> Follow </span>
              </button>
            </form>
            <% }%>
          </div>
        </div>
        <div class="col-xl-7 col-lg-8 text-center" id="centerbar">
          <% for( let userPost of userPosts){ %>

          <div class="card mt-3 mb-2 pt-3 pb-3" id="post">
            <div>
              <div class="container d-flex column">
                <div class="pe-2">
                  <% if(user.image) {%>
                  <img src="<%=user.image.pfp%>" alt="" />
                  <% } else {%>
                  <img
                    src="https://res.cloudinary.com/dyg5zmebj/image/upload//c_fill,g_face,h_60,w_60/f_png/r_max/v1688626927/Social-Media/umntgolhyfldrjkcxm27.jpg"
                    alt=""
                  />
                  <% } %>
                </div>
                <div class="container p-0 pe-3">
                  <div class="card-title d-flex" id="post-title">
                    <div class="text-start col-6" id="post-username">
                      <h4>@ <%= userPost.user %></h4>
                    </div>
                    <div class="text-end col-6">
                      <p class="me-2">- <%= userPost.created %></p>
                    </div>
                  </div>

                  <p class="text-start" id="post-content">
                    Lorem ipsum dolor sit amet consectetur adipisicing elit.
                    Laudantium pariatur consectetur harum velit temporibus
                    itaque recusandae tempora sit vitae totam beatae ipsam
                    cupiditate unde, optio amet eos, dignissimos nobis error
                    minima. Blanditiis earum quae labore. Cupiditate quas esse
                    quisquam alias necessitatibus vero distinctio ipsum labore
                    nam? Excepturi, recusandae quos. Non fugiat, rem molestias
                    similique eum eaque labore cumque nostrum aperiam
                    repudiandae quibusdam dolorum, quaerat incidunt dignissimos.
                    Sit fuga error quo ut cum modi molestias laudantium
                    expedita, saepe dolor maxime nobis non ipsa facere dolorum
                    nulla odio suscipit officiis velit repudiandae consequuntur,
                    dignissimos totam reiciendis blanditiis. Blanditiis
                    veritatis nesciunt officiis nihil.
                  </p>
                  <div class="bg-light">
                    <img
                      src="https://m.media-amazon.com/images/M/MV5BMjMxNjY2MDU1OV5BMl5BanBnXkFtZTgwNzY1MTUwNTM@._V1_.jpg"
                      alt=""
                      class="img-fluid"
                    />
                  </div>
                  <div class="d-flex mt-2" id="post-interactions">
                    <div class="d-flex col-6 pt-2">
                      <span class="material-symbols-outlined ms-1 me-2">
                        favorite
                      </span>
                      <h5>1234</h5>
                    </div>
                    <div class="d-flex justify-content-end col-6 pt-2">
                      <span class="material-symbols-outlined ms-1 me-2">
                        comment
                      </span>
                      <h5 class="me-3">14</h5>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <% }%>
        </div>
        <div
          class="col-xl-2 d-flex flex-column col-1 container p-0"
          id="right-sidebar"
        >
          <div
            class="p-0 flex-grow-1 d-flex flex-column justify-content-evenly mt-4 mb-4"
          >
            <a
              href="/social-media"
              class="text-decoration-none bg-transparent text-black"
            >
              <div class="d-flex contents">
                <span class="material-symbols-outlined fs-2 hover" id="home">
                  home
                </span>
                <h3>Home</h3>
              </div>
            </a>
            <div class="d-flex contents">
              <span class="material-symbols-outlined fs-2"> search </span>
              <h3>Find</h3>
            </div>
            <div class="d-flex contents">
              <span class="material-symbols-outlined fs-2">
                notifications
              </span>
              <h3>Invitations</h3>
            </div>
            <div class="d-flex contents">
              <span class="material-symbols-outlined fs-2"> person </span>
              <h3>Profile</h3>
            </div>
            <div class="d-flex contents">
              <span class="material-symbols-outlined fs-2"> add_circle </span>
              <h3>Post</h3>
            </div>
            <div class="d-flex contents">
              <button
                class="d-flex btn border-0 bg-transparent p-0 m-0 dropdown-toggle aria-expanded=false"
                type="button"
                data-bs-toggle="dropdown"
                id="log-out"
              >
                <ul class="dropdown-menu">
                  <li class="bg-danger">
                    <a class="dropdown-item text-white" href="#">Logout</a>
                  </li>
                </ul>
                <img
                  src="https://res.cloudinary.com/dyg5zmebj/image/upload/c_fill,g_face,h_48,w_48/f_png/r_max/v1688793640/Social-Media/zlxan6mdcglmtrommpr3.webp"
                  alt=""
                  class="img-fluid p-1"
                />
                <div class="container">
                  <h5 class="m-0 p-0 pt-1">Arya Dubal</h5>
                  <p class="m-0 p-0 text-secondary">@ redjohn</p>
                </div>
              </button>
            </div>
          </div>
        </div>
      </div>
    </section>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-geWF76RCwLtnZ8qwWowPQNguL3RmwHVBC9FhGdlKrxdiJJigb/j/68SIy3Te4Bkz"
      crossorigin="anonymous"
    ></script>
  </body>
</html>
